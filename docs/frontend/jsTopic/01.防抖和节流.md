---
title: 1. é˜²æŠ–å’ŒèŠ‚æµ
---
::: tip
å†™ä½œä¸æ˜“ï¼ŒStaræ˜¯æœ€å¤§é¼“åŠ±ï¼Œæ„Ÿè§‰å†™çš„ä¸é”™çš„å¯ä»¥ç»™ä¸ªStarâ­ï¼Œè¯·å¤šå¤šæŒ‡æ•™ã€‚[Githubåœ°å€](https://github.com/liujie2019/VuePress-Blog)ã€‚
:::
DOMæ“ä½œæ¯”èµ·éDOMæ“ä½œéœ€è¦æ›´å¤šçš„å†…å­˜å’ŒCPUï¼Œè¿ç»­å°è¯•è¿›è¡Œè¿‡å¤šçš„DOMç›¸å…³æ“ä½œå¯èƒ½ä¼šå¯¼è‡´æµè§ˆå™¨æŒ‚èµ·ï¼Œæœ‰æ—¶å€™ç”šè‡³ä¼šå´©æºƒã€‚

å¦‚æœåœ¨ç¨‹åºä¸­ä½¿ç”¨äº†onresizeäº‹ä»¶å¤„ç†ç¨‹åºï¼Œå½“è°ƒæ•´æµè§ˆå™¨å¤§å°çš„æ—¶å€™ï¼Œè¯¥äº‹ä»¶ä¼šè¿ç»­è§¦å‘ã€‚å¦‚æœåœ¨è¯¥äº‹ä»¶å¤„ç†ç¨‹åºå†…éƒ¨è¿›è¡Œäº†ç›¸å…³DOMæ“ä½œï¼Œå…¶é«˜é¢‘ç‡çš„æ›´æ”¹å¯èƒ½ä¼šå¯¼è‡´æµè§ˆå™¨å´©æºƒã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘ä½¿ç”¨å®šæ—¶å™¨å¯¹è¯¥å‡½æ•°è¿›è¡ŒèŠ‚æµã€‚
::: tip
**å‡½æ•°èŠ‚æµçš„æ ¸å¿ƒæ€æƒ³**ï¼šæŸäº›ä»£ç ä¸å¯ä»¥åœ¨æ²¡æœ‰é—´æ–­çš„æƒ…å†µä¸‹è¿ç»­é‡å¤æ‰§è¡Œã€‚ç¬¬ä¸€æ¬¡è°ƒç”¨å‡½æ•°ï¼Œåˆ›å»ºä¸€ä¸ªå®šæ—¶å™¨ï¼Œåœ¨æŒ‡å®šçš„æ—¶é—´é—´éš”ä¹‹åè¿è¡Œä»£ç ã€‚å½“ç¬¬äºŒæ¬¡è°ƒç”¨è¯¥å‡½æ•°æ—¶ï¼Œå®ƒä¼šæ¸…é™¤ä¹‹å‰çš„å®šæ—¶å™¨å¹¶è®¾ç½®å¦ä¸€ä¸ªã€‚å¦‚æœå‰ä¸€ä¸ªå®šæ—¶å™¨å·²ç»æ‰§è¡Œè¿‡äº†ï¼Œè¿™ä¸ªæ“ä½œå°±æ²¡æœ‰ä»»ä½•æ„ä¹‰ã€‚ç„¶è€Œï¼Œå¦‚æœå‰ä¸€ä¸ªå®šæ—¶å™¨å°šæœªæ‰§è¡Œï¼Œå…¶å®å°±æ˜¯å°†å…¶æ›¿æ¢ä¸ºä¸€ä¸ªæ–°çš„å®šæ—¶å™¨ã€‚ç›®çš„æ˜¯åœ¨åªæœ‰åœ¨æ‰§è¡Œå‡½æ•°çš„è¯·æ±‚åœæ­¢äº†ä¸€æ®µæ—¶é—´ä¹‹åæ‰æ‰§è¡Œã€‚
:::

ä»¥ä¸‹åœºæ™¯å¾€å¾€ç”±äºäº‹ä»¶é¢‘ç¹è¢«è§¦å‘ï¼Œå› è€Œé¢‘ç¹æ‰§è¡ŒDOMæ“ä½œã€èµ„æºåŠ è½½ç­‰é‡è¡Œä¸ºï¼Œå¯¼è‡´UIåœé¡¿ç”šè‡³æµè§ˆå™¨å´©æºƒã€‚
* windowå¯¹è±¡çš„resizeã€scrolläº‹ä»¶ï¼›
* æ‹–æ‹½æ—¶çš„mousemoveäº‹ä»¶ï¼›
* é¼ æ ‡çš„mousedownã€é”®ç›˜çš„keydown/keyup/keypressäº‹ä»¶ï¼›

å®é™…ä¸Šå¯¹äºwindowçš„resizeäº‹ä»¶ï¼Œéœ€æ±‚å¤§å¤šä¸ºåœæ­¢æ”¹å˜å¤§å°næ¯«ç§’åæ‰§è¡Œåç»­å¤„ç†ï¼›è€Œå…¶ä»–äº‹ä»¶å¤§å¤šçš„éœ€æ±‚æ˜¯ä»¥ä¸€å®šçš„é¢‘ç‡æ‰§è¡Œåç»­å¤„ç†ã€‚é’ˆå¯¹è¿™ä¸¤ç§éœ€æ±‚å°±å‡ºç°äº†debounceå’Œthrottleä¸¤ç§è§£å†³åŠæ³•ã€‚

throttle(èŠ‚æµ)å’Œdebounce(é˜²æŠ–)å…¶å®éƒ½æ˜¯**å‡½æ•°è°ƒç”¨é¢‘ç‡çš„æ§åˆ¶å™¨**ã€‚åœ¨å¤„ç†ä¸€äº›é«˜é¢‘ç‡è§¦å‘çš„`DOM`äº‹ä»¶çš„æ—¶å€™ï¼Œå®ƒä»¬éƒ½èƒ½æå¤§æé«˜ç”¨æˆ·ä½“éªŒã€‚
* `debounce`å¼ºåˆ¶å‡½æ•°åœ¨æŸæ®µæ—¶é—´å†…åªæ‰§è¡Œä¸€æ¬¡ï¼›
* `throttle`å¼ºåˆ¶å‡½æ•°ä»¥å›ºå®šçš„é€Ÿç‡æ‰§è¡Œã€‚

åœ¨å¤„ç†`resizeã€scrollã€mousemove`å’Œ`keydown/keyup/keypress`ç­‰äº‹ä»¶çš„æ—¶å€™ï¼Œé€šå¸¸æˆ‘ä»¬ä¸å¸Œæœ›è¿™äº›äº‹ä»¶å¤ªè¿‡é¢‘ç¹åœ°è§¦å‘ï¼Œå°¤å…¶æ˜¯ç›‘å¬ç¨‹åºä¸­æ¶‰åŠåˆ°å¤§é‡çš„è®¡ç®—æˆ–è€…æœ‰éå¸¸è€—è´¹èµ„æºçš„æ“ä½œã€‚

ä»¥`mousemove`äº‹ä»¶ä¸ºä¾‹ï¼Œæ ¹æ®`DOM Level 3`çš„è§„å®šï¼Œå¦‚æœé¼ æ ‡è¿ç»­ç§»åŠ¨ï¼Œé‚£ä¹ˆæµè§ˆå™¨å°±åº”è¯¥è§¦å‘å¤šä¸ªè¿ç»­çš„`mousemove`äº‹ä»¶ï¼Œè¿™æ„å‘³ç€æµè§ˆå™¨ä¼šåœ¨å…¶å†…éƒ¨è®¡æ—¶å™¨å…è®¸çš„æƒ…å†µä¸‹ï¼Œæ ¹æ®ç”¨æˆ·ç§»åŠ¨é¼ æ ‡çš„é€Ÿåº¦æ¥è§¦å‘`mousemove`äº‹ä»¶ã€‚`resizeã€scrollå’Œkey*`ç­‰äº‹ä»¶ä¸æ­¤ç±»ä¼¼ã€‚
## Debounce(é˜²æŠ–)
DOMäº‹ä»¶é‡Œçš„`debounce`æ¦‚å¿µå…¶å®æ˜¯ä»æœºæ¢°å¼€å…³å’Œç»§ç”µå™¨çš„`å»å¼¹è·³ï¼ˆdebounceï¼‰`è¡ç”Ÿè€Œæ¥çš„ï¼ŒåŸºæœ¬æ€è·¯å°±æ˜¯ï¼šæŠŠå¤šä¸ªä¿¡å·åˆå¹¶ä¸ºä¸€ä¸ªä¿¡å·ã€‚

åœ¨jsä¸­ï¼Œ`debounce`å‡½æ•°ä½œç”¨å°±æ˜¯ï¼š**é™åˆ¶ä¸€ä¸ªå‡½æ•°åœ¨æŸä¸ªè¿ç»­çš„æ—¶é—´æ®µå†…åªæ‰§è¡Œä¸€æ¬¡**ï¼Œå“ªæ€•å®ƒæœ¬æ¥ä¼šè¢«è°ƒç”¨å¤šæ¬¡ã€‚æˆ‘ä»¬å¸Œæœ›åœ¨ç”¨æˆ·åœæ­¢æŸä¸ªæ“ä½œä¸€æ®µæ—¶é—´ä¹‹åæ‰æ‰§è¡Œç›¸åº”çš„ç›‘å¬å‡½æ•°ï¼Œè€Œä¸æ˜¯åœ¨ç”¨æˆ·æ“ä½œçš„è¿‡ç¨‹å½“ä¸­ï¼Œæµè§ˆå™¨è§¦å‘å¤šå°‘æ¬¡äº‹ä»¶ï¼Œå°±æ‰§è¡Œå¤šå°‘æ¬¡ç›‘å¬å‡½æ•°ã€‚

ä¸¾ä¸ªğŸŒ°ï¼šåœ¨3sé’Ÿå†…è¿ç»­åœ°ç§»åŠ¨é¼ æ ‡ï¼Œæµè§ˆå™¨å¯èƒ½ä¼šè§¦å‘å‡ åï¼ˆç”šè‡³å‡ ç™¾ï¼‰ä¸ª`mousemove`äº‹ä»¶ï¼Œä¸ä½¿ç”¨`debounce`çš„è¯ï¼Œç›‘å¬å‡½æ•°å°±è¦æ‰§è¡Œè¿™ä¹ˆå¤šæ¬¡ï¼›å¦‚æœå¯¹ç›‘å¬å‡½æ•°ä½¿ç”¨`100ms`çš„`å»å¼¹è·³`ï¼Œé‚£ä¹ˆæµè§ˆå™¨åªä¼šæ‰§è¡Œä¸€æ¬¡è¿™ä¸ªç›‘å¬å‡½æ•°ï¼Œè€Œä¸”æ˜¯åœ¨ç¬¬`3.1s`çš„æ—¶å€™æ‰§è¡Œçš„ã€‚
### ä»£ç å®ç°
debounceå‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯è¦`å»å¼¹è·³`çš„å›è°ƒå‡½æ•°fnï¼Œç¬¬äºŒä¸ªæ˜¯å»¶è¿Ÿçš„æ—¶é—´delayã€‚å®é™…ä¸Šï¼Œå¤§éƒ¨åˆ†çš„å®Œæ•´debounceå®ç°è¿˜æœ‰ç¬¬ä¸‰ä¸ªå‚æ•°`immediate`ï¼Œè¡¨æ˜å›è°ƒå‡½æ•°æ˜¯åœ¨ä¸€ä¸ªæ—¶é—´åŒºé—´çš„æœ€å¼€å§‹æ‰§è¡Œ`(immediateä¸ºtrue)`è¿˜æ˜¯æœ€åæ‰§è¡Œ`(immediateä¸ºfalse)`ï¼Œæ¯”å¦‚underscoreçš„`_.debounce`ã€‚è¿™é‡Œå…ˆä¸è€ƒè™‘è¿™ä¸ªå‚æ•°ï¼Œåªè€ƒè™‘æœ€åæ‰§è¡Œçš„æƒ…å†µï¼š
```js
// è€ƒè™‘æœ€åæ‰§è¡Œçš„æƒ…å†µ
function debounce(fn, delay) {
    if(!fn instanceof Function) {
        throw new TypeError('Expected a function');
    }
    let timer = null;
    return function(...args) {
        clearTimeout(timer);
        timer = setTimeout(() => {
            fn.apply(this, args);
        }, delay);
    }
}
```
::: tip
æ ¸å¿ƒæ€æƒ³ï¼šdebounceå‡½æ•°è¿”å›äº†ä¸€ä¸ªé—­åŒ…ï¼Œè¿™ä¸ªé—­åŒ…å‡½æ•°ä¾ç„¶ä¼šè¢«è¿ç»­æ‰§è¡Œã€‚ä½†æ˜¯åœ¨é—­åŒ…å†…éƒ¨ï¼Œé€šè¿‡å®šæ—¶å™¨é™åˆ¶äº†fnå‡½æ•°çš„æ‰§è¡Œé¢‘ç‡ï¼Œå¼ºåˆ¶fnå‡½æ•°åªåœ¨è¿ç»­æ“ä½œåœæ­¢åçš„æŒ‡å®šæ—¶é—´(delayå‚æ•°)åæ‰§è¡Œä¸€æ¬¡ã€‚
:::
ç¬¬ä¸€æ¬¡è§¦å‘åï¼Œè¿›è¡Œå€’è®¡delayæ¯«ç§’ï¼Œå¦‚æœå€’è®¡æ—¶è¿‡ç¨‹ä¸­æœ‰å…¶ä»–è§¦å‘ï¼Œåˆ™æ¸…æ¥šè®¡æ—¶å™¨ï¼›å¦åˆ™æ‰§è¡Œfnã€‚ç”¨é˜²æŠ–æ¥ä¸¢å¼ƒä¸€äº›é‡å¤çš„å¯†é›†æ“ä½œã€æ´»åŠ¨ï¼Œç›´åˆ°æµé‡å‡æ…¢ã€‚
### é˜²æŠ–åº”ç”¨
1. åˆ—è¡¨æ•°æ®çš„æ¨¡ç³ŠæŸ¥è¯¢(æ ¹æ®ç”¨æˆ·è¾“å…¥è·å–å¯¹åº”çš„æœåŠ¡ç«¯æ•°æ®)ï¼Œå½“ç”¨æˆ·è¾“å…¥å†…å®¹è¿‡å¿«æ—¶ï¼Œ`key*`äº‹ä»¶è¢«è§¦å‘çš„é¢‘ç‡ä¹Ÿæ˜¯å¾ˆé«˜çš„ï¼Œå¦‚æœæŒ‰ç…§ç”¨æˆ·è¾“å…¥é€Ÿåº¦é«˜é¢‘ç‡åœ°å‘é€è¯·æ±‚ï¼Œä¸€æ–¹é¢æˆ‘ä»¬å¹¶æ²¡æœ‰æ‹¿åˆ°ç”¨æˆ·çš„å®Œæ•´è¾“å…¥å‘é€ç»™æœåŠ¡å™¨ï¼ŒäºŒæ˜¯è¿™ç§é¢‘ç¹çš„æ— ç”¨è¯·æ±‚æ˜¯æ²¡æœ‰å¿…è¦ï¼Œå› ä¸ºå¤§éƒ¨åˆ†çš„è¯·æ±‚ç»“æœå¹¶ä¸æ˜¯ç”¨æˆ·æƒ³è¦çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç”¨æˆ·è¾“å…¥å†…å®¹ç»“æŸåï¼Œåœæ­¢æŒ‡å®šæ—¶é—´(delayå‚æ•°)å†å»è·å–æ•°æ®ï¼›
2. æŒ‰é’®æäº¤æ“ä½œï¼Œå¦‚æœå¤šæ¬¡ç‚¹å‡»æŒ‰é’®ï¼Œåªæœ‰æœ€åä¸€æ¬¡æœ‰æ•ˆï¼›
3. è¡¨å•æ ¡éªŒï¼Œå¯¹ç”¨æˆ·è¾“å…¥çš„å†…å®¹è¿›è¡Œæ£€æŸ¥ï¼Œåªæœ‰åœ¨ç”¨æˆ·åœæ­¢è¾“å…¥ååœæ­¢æŒ‡å®šæ—¶é—´(delayå‚æ•°)å†è¿›è¡Œåˆæ³•æ€§çš„æ ¡éªŒï¼›
4. æµè§ˆå™¨çª—å£çš„resizeäº‹ä»¶ï¼Œå½“çª—å£å¤§å°åœæ­¢å˜åŒ–ä¹‹åå†é‡æ–°è®¡ç®—å¸ƒå±€ã€‚

```js
$('input').on('keyup', debounce(() => {
	// å‘é€ajaxè¯·æ±‚
}, 200))
```
å†ä¸‹é¢ä¸¤ä¸ªæ›´å…·ä½“çš„ä¾‹å­ï¼š
```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>é˜²æŠ–</title>
    <style>
        #box, #box2 {
            width: 100px;
            height: 100px;
            background-color: aquamarine;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div id="box"></div>
    <div id="box2"></div>
    <script>
        function debounce(fn, delay) {
            if(!fn instanceof Function) {
                throw new TypeError('Expected a function');
            }
            let timer = null;
            return function(...args) {
                clearTimeout(timer);
                timer = setTimeout(() => {
                    fn.apply(this, args);
                }, delay);
            }
        }
        const box = document.querySelector('#box');
        const box2 = document.querySelector('#box2');
        let count = 0;
        let count2 = 0;
        // ä¸è¿›è¡Œé˜²æŠ–å¤„ç†
        document.addEventListener('mousemove', () => {
            count++;
            box.innerHTML = count;
        }, false);
        document.addEventListener('mousemove', debounce(() => {
            count2++;
            box2.innerHTML = count2;
        }, 200), false);
    </script>
</body>
</html>
```
```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>é˜²æŠ–</title>
    <style>
        #box {
            width: 100px;
            height: 100px;
            background-color: aquamarine;
        }
    </style>
</head>
<body>
    <div id="box"></div>
    <script>
        function debounce(fn, delay) {
            if(!fn instanceof Function) {
                throw new TypeError('Expected a function');
            }
            let timer = null;
            return function(...args) {
                if (timer) clearTimeout(timer);
                timer = setTimeout(() => {
                    fn.apply(this, args);
                }, delay);
            }
        }
        const box = document.querySelector('#box');
        let count = 0;
        window.addEventListener('resize', () => {
            box.innerHTML = ++count;
        }, false);
        // é˜²æŠ–å¤„ç†
        window.addEventListener('resize', debounce(() => {
            box.innerHTML = ++count;
        }, 200), false);
    </script>
</body>
</html>
```
## Throttle(èŠ‚æµ)
æ‰€è°“çš„èŠ‚æµå°±æ˜¯å›ºå®šå‡½æ•°æ‰§è¡Œçš„é¢‘ç‡ã€‚æ­£å¸¸æƒ…å†µä¸‹ï¼Œå‡è®¾`mousemove`çš„ç›‘å¬å‡½æ•°æ¯20msæ‰§è¡Œä¸€æ¬¡ï¼Œå¦‚æœè®¾ç½®200msçš„èŠ‚æµï¼Œé‚£ä¹ˆå®ƒå°±ä¼šæ¯200msæ‰§è¡Œä¸€æ¬¡ã€‚æ¯”å¦‚åœ¨1sçš„æ—¶é—´æ®µå†…ï¼Œæ­£å¸¸çš„ç›‘å¬å‡½æ•°å¯èƒ½ä¼šæ‰§è¡Œ50æ¬¡ï¼ŒèŠ‚æµ200msååˆ™ä¼šæ‰§è¡Œ5æ¬¡ã€‚
### å…·ä½“å®ç°
åŸºäºæ—¶é—´æˆ³å®ç°ï¼š
```js
function throttle(fn, delay) {
   if(!fn instanceof Function) {
        throw new TypeError('Expected a function');
   }
   let preTime = Date.now();
   return function(...args) {
       const curTime = Date.now();
       // æ—¶é—´é—´éš”å¤§äºdelayæ—¶æ‰§è¡Œä¸€æ¬¡ï¼Œå¹¶æ›´æ–°preTimeçš„å€¼
       if (curTime - preTime >= delay) {
           fn.apply(this, args);
           preTime = curTime;
       }
   }
}
```
åŸºäºsetTimeoutå’Œæ—¶é—´æˆ³å®ç°ï¼š
```js
function throttle(fn, delay = 250) {
   if(!fn instanceof Function) {
       throw new TypeError('Expected a function');
   }
   let preTime = Date.now();
   let timer = null;
   return function(...args) {
       let curTime = Date.now();
       if (preTime + delay > curTime) {
           clearTimeout(timer);
           timer = setTimeout(() => {
               fn.apply(this, args);
               preTime = curTime;
           }, delay);
       } else {
           fn.apply(this, args);
           preTime = curTime;
       }
   }
}
```
### èŠ‚æµä¸¤ç§æ–¹å¼å¯¹æ¯”
ç¬¬ä¸€ç§ï¼šå¦‚æœåœ¨ä¸€ä¸ªdelayé—´éš”å†…å¤šæ¬¡è§¦å‘ï¼Œfnåªä¼šè¢«æ‰§è¡Œä¸€æ¬¡ï¼Œæœ€åä¸€æ¬¡å¹¶ä¸ä¼šè¿›å…¥ä¸‹ä¸€ä¸ªå‘¨æœŸæ‰§è¡Œã€‚
ç¬¬äºŒç§ï¼šåœ¨ä¸€ä¸ªdelayé—´éš”å†…å¤šæ¬¡è§¦å‘ï¼Œfnæ€»å…±ä¼šæ‰§è¡Œä¸¤æ¬¡ï¼Œæ³¨æ„ï¼šç¬¬äºŒæ¬¡ä¼šè¿›å…¥ä¸‹ä¸€ä¸ªdelayå‘¨æœŸæ‰§è¡Œã€‚
### èŠ‚æµåº”ç”¨
ä¸debounceç±»ä¼¼ï¼Œthrottleä¹Ÿæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªå®é™…è¦æ‰§è¡Œçš„å‡½æ•°fnï¼Œä¸€ä¸ªæ‰§è¡Œé—´éš”é˜ˆå€¼threshholdã€‚

åŒæ ·çš„ï¼Œ`throttle`çš„æ›´å®Œæ•´å®ç°å¯ä»¥å‚çœ‹`underscore`çš„ `_.throttle`ã€‚
```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>èŠ‚æµ</title>
    <style>
        #box {
            width: 100px;
            height: 100px;
            background-color: aquamarine;
        }
    </style>
</head>
<body>
    <div id="box"></div>
    <script>
        function throttle(fn, delay) {
            if(!fn instanceof Function) {
                 throw new TypeError('Expected a function');
            }
            let preTime = Date.now();
            return function(...args) {
                const curTime = Date.now();
                // æ—¶é—´é—´éš”å¤§äºdelayæ—¶æ‰§è¡Œä¸€æ¬¡ï¼Œå¹¶æ›´æ–°preTimeçš„å€¼
                if (curTime - preTime >= delay) {
                    fn.apply(this, args);
                    preTime = curTime;
                }
            }
        }
        const box = document.querySelector('#box');
        let count = 0;
        window.addEventListener('resize', throttle(() => {
            box.innerHTML = ++count;
        }, 3000), false);
    </script>
</body>
</html>
```
```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        .wrapper {
            width: 200px;
            height: 200px;
            float: left;
            border: 1px solid #ddd;
            overflow: auto;
            position: relative;
        }
        .wrapper .content {
            height: 100%;
            width: 100%;
            overflow: auto;
        }
        .content .inner {
            height: 6000px;
        }
        .wrapper .desc {
            position: absolute;
        }
        .wrapper .count {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        .normal {
            margin-right: 20px;
        }
    </style>
</head>
<body>
    <h3>Try scrolling in the 2 boxes...</h3>
    <div>
        <div class="wrapper normal">
            <div class="desc">Normal scroll</div>
            <div class="content">
                <div class="inner"></div>
            </div>
            <span id="normal" class="count">0</span>
        </div>
        <div class="wrapper throttled">
            <div class="desc">Throttled scroll</div>
            <div class="content">
                <div class="inner"></div>
            </div>
            <span id="throttled" class="count">0</span>
        </div>
    </div>
    <script>
        function throttle(fn, threshhold = 250) { // é»˜è®¤é—´éš”ä¸º250ms
            // è®°å½•ä¸Šæ¬¡æ‰§è¡Œçš„æ—¶é—´
            var last;
            // å®šæ—¶å™¨
            var timer = null;
            // è¿”å›å‡½æ•°ï¼Œæ¯éš”threshholdæ¯«ç§’å°±æ‰§è¡Œä¸€æ¬¡fnå‡½æ•°
            return function(...args) {
                var now = +new Date(); // åŠ å·çš„ä½œç”¨æ˜¯å°†æ—¥æœŸè½¬ä¸ºæ—¶é—´æˆ³
                // å¦‚æœè·ç¦»ä¸Šæ¬¡æ‰§è¡Œfnå‡½æ•°çš„æ—¶é—´å°äºthreshholdï¼Œå°±ä¸æ‰§è¡Œfn
                // å¦åˆ™æ‰§è¡Œfnï¼Œå¹¶é‡æ–°è®¡æ—¶
                if (last && now < last + threshhold) {
                    clearTimeout(timer);
                    // ä¿è¯åœ¨å½“å‰æ—¶é—´åŒºé—´ç»“æŸåï¼Œå†æ‰§è¡Œä¸€æ¬¡fn
                    timer = setTimeout(() => {
                        last = now;
                        fn.apply(this, args);
                    }, threshhold);
                }
                else {
                    last = now;
                    fn.apply(this, args);
                }
            }
        }
        var normalCount = 0;
        var throttledCount = 0;
        var normalSpan = document.querySelector('#normal');
        var throttledSpan = document.querySelector('#throttled');
        var normalContent = document.querySelector('.normal .content');
        var throttledContent = document.querySelector('.throttled .content');
        normalContent.addEventListener('scroll', function() {
            normalSpan.innerText = ++normalCount;
        }, false);
        throttledContent.addEventListener('scroll', throttle(function() {
            throttledSpan.innerText = ++throttledCount;
        }, 250), false);
        document.addEventListener('mouseleave', function() {
            normalCount = 0;
            throttledCount = 0;
            normalSpan.innerText = 0;
            throttledSpan.innerText = 0;
        }, false);
    </script>
</body>
</html>
```
åŸç†ä¹Ÿä¸å¤æ‚ï¼Œç›¸æ¯”debounceï¼Œæ— éæ˜¯å¤šäº†ä¸€ä¸ªæ—¶é—´é—´éš”çš„åˆ¤æ–­ï¼Œå…¶ä»–çš„é€»è¾‘åŸºæœ¬ä¸€è‡´ã€‚throttleçš„ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š
```js
$(document).on('mouvemove', throttle(() => {
	// ä»£ç 
}, 250))
```
### throttleä½¿ç”¨åœºæ™¯
* throttleå¸¸ç”¨çš„åœºæ™¯æ˜¯é™åˆ¶mousemoveã€resizeå’Œscroll(é¼ æ ‡æ»šåŠ¨ã€window.resize)çš„è§¦å‘é¢‘ç‡ã€‚

ç¬¬ä¸€æ¬¡è§¦å‘åå…ˆæ‰§è¡Œfn(å½“ç„¶å¯ä»¥é€šè¿‡{leading: false}æ¥å–æ¶ˆ)ï¼Œç„¶åwait msåå†æ¬¡æ‰§è¡Œï¼Œåœ¨å•ä½waitæ¯«ç§’å†…çš„æ‰€æœ‰é‡å¤è§¦å‘éƒ½è¢«æŠ›å¼ƒã€‚å³å¦‚æœæœ‰è¿ç»­ä¸æ–­çš„è§¦å‘ï¼Œæ¯wait msæ‰§è¡Œfnä¸€æ¬¡ã€‚

## ä¸šåŠ¡åœºæ™¯ä½¿ç”¨
ä¸€ä¸ªå¸¸è§çš„ä¾‹å­ï¼šç”¨æˆ·åœ¨æ— é™æ»šåŠ¨çš„é¡µé¢ä¸Šå‘ä¸‹æ»šåŠ¨é¼ æ ‡åŠ è½½é¡µé¢ï¼Œä½ éœ€è¦åˆ¤æ–­ç°åœ¨è·é¡µé¢åº•éƒ¨çš„é«˜åº¦ã€‚å¦‚æœç”¨æˆ·å¿«æ¥è¿‘é¡µé¢åº•éƒ¨æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥å‘é€è¯·æ±‚æ¥åŠ è½½æ›´å¤šå†…å®¹åˆ°é¡µé¢ã€‚åœ¨æ­¤debounceæ²¡æœ‰ç”¨ï¼Œå› ä¸ºå®ƒåªä¼šåœ¨ç”¨æˆ·åœæ­¢æ»šåŠ¨æ—¶è§¦å‘ï¼Œä½†æˆ‘ä»¬éœ€è¦ç”¨æˆ·å¿«åˆ°è¾¾åº•éƒ¨æ—¶å»è¯·æ±‚ã€‚é€šè¿‡throttleæˆ‘ä»¬å¯ä»¥ä¸é—´æ–­çš„ç›‘æµ‹è·ç¦»åº•éƒ¨å¤šè¿œã€‚
```js
$(document).ready(function(){
  // è¿™é‡Œè®¾ç½®æ—¶é—´é—´éš”ä¸º300ms
  $(document).on('scroll', throttle(function(){
    check_if_needs_more_content();
  }, 300));

  // æ˜¯å¦éœ€è¦åŠ è½½æ›´å¤šèµ„æº
  function check_if_needs_more_content() {
    var pixelsFromWindowBottomToBottom = 0 + $(document).height() - $(window).scrollTop() - $(window).height();
    // æ»šåŠ¨æ¡è·ç¦»é¡µé¢åº•éƒ¨å°äº200ï¼ŒåŠ è½½æ›´å¤šå†…å®¹
    if (pixelsFromWindowBottomToBottom < 200){
      // åŠ è½½æ›´å¤šå†…å®¹
      $('body').append($('.item').clone());
    }
  }
});
```
## debounceå’Œthrottleçš„å·®å¼‚(å¯è§†åŒ–å±•ç¤º)
![image](./assets/debounce.gif)

## é¡¹ç›®å®ä¾‹
Vueå®˜ç½‘é‡Œçš„ä¸€ä¸ªğŸŒ°ï¼Œå°±æ˜¯ç”¨äºå¯¹ç”¨æˆ·è¾“å…¥çš„äº‹ä»¶è¿›è¡Œäº†é˜²æŠ–å¤„ç†ï¼Œå› ä¸ºç”¨æˆ·è¾“å…¥åéœ€è¦è¿›è¡Œajaxè¯·æ±‚ï¼Œå¦‚æœä¸è¿›è¡Œé˜²æŠ–ä¼šé¢‘ç¹çš„å‘é€ajaxè¯·æ±‚ï¼Œæ‰€ä»¥é€šè¿‡debounceå¯¹ajaxè¯·æ±‚çš„é¢‘ç‡è¿›è¡Œäº†é™åˆ¶ã€‚
```js
methods: {
  // `_.debounce` æ˜¯ä¸€ä¸ªé€šè¿‡Lodashé™åˆ¶æ“ä½œé¢‘ç‡çš„å‡½æ•°ã€‚
  // åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›é™åˆ¶è®¿é—® yesno.wtf/api çš„é¢‘ç‡
  // AJAX è¯·æ±‚ç›´åˆ°ç”¨æˆ·è¾“å…¥å®Œæ¯•æ‰ä¼šå‘å‡ºã€‚æƒ³è¦äº†è§£æ›´å¤šå…³äº
  getAnswer: _.debounce(function() {
    if (!reg.test(this.question)) {
      this.answer = 'Questions usually end with a question mark. ;-)';
      return;
    }
    this.answer = 'Thinking ... ';
    let self = this;
    axios.get('https://yesno.wtf/api')
    // thenä¸­çš„å‡½æ•°å¦‚æœä¸æ˜¯ç®­å¤´å‡½æ•°ï¼Œåˆ™éœ€è¦å¯¹thisèµ‹å€¼self
    .then(response => {
      this.answer = _.capitalize(response.data.answer)
    }).
    catch (error => {
      this.answer = 'Error! Could not reach the API. ' + error
    })
  }, 500) // è¿™æ˜¯æˆ‘ä»¬ä¸ºåˆ¤å®šç”¨æˆ·åœæ­¢è¾“å…¥ç­‰å¾…çš„æ¯«ç§’æ•°
},
```
## é˜²æŠ–å’ŒèŠ‚æµçš„å¼‚åŒ
ç›¸åŒç‚¹ï¼š
* å…¶å®æœ¬è´¨ä¸Šéƒ½æ˜¯ä¸ºäº†èŠ‚çœç¨‹åºçš„æ€§èƒ½ï¼ˆé˜²æ­¢å‡½æ•°è¢«é¢‘ç¹è°ƒç”¨ï¼‰
* å€ŸåŠ©äº†é—­åŒ…çš„ç‰¹æ€§æ¥ç¼“å­˜å˜é‡
* éƒ½å¯ä»¥ä½¿ç”¨setTimeoutå®ç°

åŒºåˆ«ï¼š
* ä½¿ç”¨é˜²æŠ–ï¼Œå¯èƒ½nä¸ªthreshholdæ—¶é—´é—´éš”ä¹‹åfnä¹Ÿæ²¡æ‰§è¡Œï¼Œä½†æ˜¯ä½¿ç”¨èŠ‚æµï¼Œåœ¨threshholdé—´éš”å†…æœ‰ä¸”åªæ‰§è¡Œä¸€æ¬¡ï¼›
* åŒæ ·threshholdé—´éš”å†…è¿ç»­è§¦å‘ï¼Œé˜²æŠ–åªæ‰§è¡Œä¸€æ¬¡ï¼Œè€ŒèŠ‚æµä¼šæ‰§è¡Œä¸¤æ¬¡ï¼Œåªæ˜¯åœ¨ä¸åŒçš„threshholdå‘¨æœŸå†…ï¼›
* ä¾§é‡ç‚¹ä¸åŒï¼Œé˜²æŠ–ä¾§é‡äºç¨³å®šåªèƒ½æ‰§è¡Œä¸€æ¬¡ï¼Œè€ŒèŠ‚æµå¼ºè°ƒé™å‘¨æœŸå†…æ¬¡æ•°ï¼Œå³æ‰§è¡Œé¢‘ç‡ï¼Œä¸é™åˆ¶æ‰€æœ‰æ—¶é—´å†…çš„æ€»æ¬¡æ•°ã€‚
## å‚è€ƒæ–‡æ¡£
1. [æ·±å…¥æµ…å‡ºé˜²æŠ–å‡½æ•° debounce](https://github.com/yygmind/blog/issues/39)
2. [Debounce å’Œ Throttle çš„åŸç†åŠå®ç°](https://blog.csdn.net/redtopic/article/details/69396722)
3. [debounce å’Œ throttle çš„å¯è§†åŒ–å·®å¼‚](http://demo.nimius.net/debounce_throttle/)
4. [å‡½æ•°å»æŠ–ï¼ˆdebounceï¼‰å’Œå‡½æ•°èŠ‚æµï¼ˆthrottleï¼‰](https://blog.csdn.net/duola8789/article/details/78871789)
5. [debounceä¸throttleåŒºåˆ«](https://blog.csdn.net/ligang2585116/article/details/75003436)
6. [JSé«˜çº§æŠ€å·§å­¦ä¹ å°ç»“](https://blog.csdn.net/liujie19901217/article/details/51020339)
7. [7åˆ†é’Ÿç†è§£JSçš„èŠ‚æµã€é˜²æŠ–åŠä½¿ç”¨åœºæ™¯](https://juejin.im/post/5b8de829f265da43623c4261)
8. [å‰ç«¯æˆ˜äº”æ¸£å­¦JavaScriptâ€”â€”é˜²æŠ–ã€èŠ‚æµå’ŒrAF](https://juejin.im/post/5cce5380f265da03826129bf)