---
title: 4. ç®­å¤´å‡½æ•°
---
::: tip
å†™ä½œä¸æ˜“ï¼ŒStaræ˜¯æœ€å¤§é¼“åŠ±ï¼Œæ„Ÿè§‰å†™çš„ä¸é”™çš„å¯ä»¥ç»™ä¸ªStarâ­ï¼Œè¯·å¤šå¤šæŒ‡æ•™ã€‚[æœ¬åšå®¢çš„Githubåœ°å€](https://github.com/liujie2019/VuePress-Blog)ã€‚
:::
[TOC]
ç®­å¤´å‡½æ•°ï¼Œå°±æ˜¯å‡½æ•°çš„ç®€å†™ã€‚å¦‚æœåªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œ()å¯ä»¥çœï¼Œå¦‚æœåªæœ‰ä¸€ä¸ªreturnï¼Œ{}å¯ä»¥çœã€‚
ç®­å¤´å‡½æ•°ä½œç”¨ï¼šå®šä¹‰åŒ¿åå‡½æ•°(å¤šæ•°æƒ…å†µä¸‹ç”¨æ¥å®šä¹‰å›è°ƒå‡½æ•°)ã€‚

ç‰¹ç‚¹ï¼š
* è¯­æ³•ç®€æ´ï¼›
* æ²¡æœ‰è‡ªå·±çš„thisï¼Œç®­å¤´å‡½æ•°å®šä¹‰æ—¶æ‰€å¤„çš„ä½œç”¨åŸŸçš„thisæŒ‡å‘å°±æ˜¯å…¶thisæŒ‡å‘ï¼›
* ç®­å¤´å‡½æ•°å¤–å±‚æœ‰å‡½æ•°ï¼Œåˆ™å½“å‰ç®­å¤´å‡½æ•°çš„thisåŒå¤–å±‚å‡½æ•°çš„thisæŒ‡å‘ç›¸åŒï¼Œå¦åˆ™ç®­å¤´å‡½æ•°çš„thisæŒ‡å‘windowã€‚

è¯­æ³•ï¼š
* æ²¡æœ‰å‚æ•°: () => console.log('xxxx')
* ä¸€ä¸ªå‚æ•°: a => a + 2
* å¤§äºä¸€ä¸ªå‚æ•°: (a, b) => a + b
* å‡½æ•°ä½“ä¸ç”¨å¤§æ‹¬å·ï¼Œé»˜è®¤è¿”å›ç»“æœ
* å‡½æ•°ä½“å¦‚æœæœ‰å¤šæ¡è¯­å¥ï¼Œéœ€è¦ç”¨{}åŒ…å›´ï¼Œè‹¥æœ‰éœ€è¦è¿”å›çš„å†…å®¹ï¼Œéœ€è¦æ‰‹åŠ¨è¿”å›(å³return 'xxx';)ã€‚

```js
// æ™®é€šå‡½æ•°
function name() {}

// ç®­å¤´å‡½æ•°ï¼Œå»æ‰functionï¼ŒåŠ ä¸Š=>
// ç®­å¤´å‡½æ•°æ˜¯åŒ¿åå‡½æ•°
() => {}
```
```js
let show1 = function () {
    console.log('abc')
}

let show2 = () => {
    console.log('abc')
}

show1(); // è°ƒç”¨å‡½æ•°
show2();

let show4 = function (a) {
    return a * 2
}

let show5 = a => a * 2 // ç®€æ´ï¼Œç±»ä¼¼python lambda å‡½æ•°

console.log(show4(10));
console.log(show5(10));
```
## ç®­å¤´å‡½æ•°thisæŒ‡å‘
```js
const person = {
    name: 'lisi',
    hobbies: ['Coding', 'Sleeping', 'Reading'],
    sayHobbies() {
        // console.log(this); // person
        // è€ŒforEachä¸­çš„å›è°ƒå‡½æ•°æ—¢æ²¡æœ‰é€šè¿‡å¯¹è±¡è°ƒç”¨ï¼Œä¹Ÿæ²¡æœ‰é€šè¿‡call/applyæ¥ç‰¹æ„æŒ‡å®šthisæŒ‡å‘ï¼Œé‚£ä¹ˆthisé»˜è®¤æ˜¯æŒ‡å‘windowçš„ï¼Œä¸¥æ ¼æ¨¡å¼ä¸‹æŒ‡å‘æ˜¯undefinedã€‚
        this.hobbies.forEach(function(hobby) {
            // console.log(this); // Window
            console.log(`${this.name} loves ${hobby}`);
        });
    }
}
// ES5ä¸­å‡½æ•°çš„thisæŒ‡å‘è°ƒç”¨å‡½æ•°æ—¶çš„å¯¹è±¡
// è¿™é‡ŒsayHobbieså‡½æ•°æ˜¯personå¯¹è±¡è°ƒç”¨çš„ï¼Œå› æ­¤sayHobbieså‡½æ•°ä¸­çš„thisæŒ‡å‘person
person.sayHobbies();
```
åœ¨ES6ä¹‹å‰ï¼Œæˆ‘ä»¬ä¸€èˆ¬é€šè¿‡ä¿å­˜thisæŒ‡å‘çš„æ–¹å¼æ¥è§£å†³å›è°ƒå‡½æ•°ä¸­thisæŒ‡å‘é—®é¢˜ã€‚
```js
const person = {
    name: 'lisi',
    hobbies: ['Coding', 'Sleeping', 'Reading'],
    sayHobbies() {
        // console.log(this); // person
        const self = this;
        this.hobbies.forEach(function(hobby) {
            // console.log(this); // Window
            console.log(`${self.name} loves ${hobby}`);
        });
    }
}

person.sayHobbies();
```
åœ¨ES6ä¸­ï¼Œå¯ä»¥é€šè¿‡ç®­å¤´å‡½æ•°æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚
```js
const person = {
    name: 'lisi',
    hobbies: ['Coding', 'Sleeping', 'Reading'],
    sayHobbies() {
        // console.log(this); // person
        this.hobbies.forEach(hobby => {
            // æ”¹ç”¨ç®­å¤´å‡½æ•°ï¼Œç®­å¤´å‡½æ•°ä¸­æ²¡æœ‰thisï¼Œå…¶thisæŒ‡å‘æ˜¯ç»§æ‰¿è‡ªå…¶çˆ¶ä½œç”¨åŸŸçš„thisã€‚
            // console.log(this); // person
            console.log(`${this.name} loves ${hobby}`);
        });
    }
}
person.sayHobbies();
```
```js
// ç®­å¤´å‡½æ•° this
var name = 'windowName';
const obj = {
    name: 'lisi',
    say() {
        setTimeout(function() {
            console.log(this); // setTimeoutä¸­thisé»˜è®¤æŒ‡å‘window
            console.log('name:', this.name);
        }, 100);
    },
    sayWithThis() { // sayWithThisè¿™é‡ŒthisæŒ‡å‘obj
        let that = this; // setTimeoutå›è°ƒå–çš„æ˜¯sayWithThisé‡Œçš„thisæŒ‡å‘
        setTimeout(function() {
            console.log('this id:', that.name);
        }, 1000);
    },
    sayWithArrow() { // sayWithArrowè¿™é‡ŒthisæŒ‡å‘obj
        setTimeout(() => { // setTimeoutç®­å¤´å‡½æ•°å›è°ƒçš„thiså–æœ€è¿‘ä¸€å±‚éç®­å¤´å‡½æ•°çš„thisæŒ‡å‘
            console.log('array:', this.name);
        }, 1500);
    },
    sayWithGlobalArrow: () => { // ç¬¬ä¸€å±‚ç®­å¤´å‡½æ•°çš„thisæŒ‡å‘window
        setTimeout(() => {
            console.log('global array:', this.name);
        }, 2000);
    }
};
obj.say(); // name: windowName
obj.sayWithThis(); // this id: lisi
obj.sayWithArrow(); // array: lisi
obj.sayWithGlobalArrow(); // global array: windowName
```
::: tip
éœ€è¦æ³¨æ„ï¼šç®­å¤´å‡½æ•°ä¸­çš„thisæŒ‡å‘æ˜¯åœ¨å‡½æ•°å®šä¹‰æ—¶å°±ç¡®å®šå¥½çš„ï¼Œè·Ÿæ™®é€šå‡½æ•°ä¸­thisæŒ‡å‘éœ€è¦åœ¨å‡½æ•°è°ƒç”¨çš„æ—¶å€™æ‰èƒ½ç¡®å®šä¸ä¸€æ ·ã€‚
ç®­å¤´å‡½æ•°åº”ç”¨åœºæ™¯ï¼šå¸Œæœ›å‡½æ•°ç»‘å®šå…¶çˆ¶çº§ä½œç”¨åŸŸçš„thisæŒ‡å‘ï¼Œå¹¶ä¸”ä¸å¸Œæœ›ç®­å¤´å‡½æ•°åœ¨è°ƒç”¨æ—¶å…¶thisæŒ‡å‘å‘ç”Ÿæ”¹å˜ã€‚
:::
## å‡½æ•°å½¢å‚é»˜è®¤å€¼
```js
function add(a, b) {
    a = a || 5;
    b = b || 6;
    return a + b;
}

console.log(add()); // 11
console.log(add(1, 2)); // 3
```
é‡‡ç”¨é»˜è®¤å‚æ•°å†™æ³•ï¼š
```js
function add(a = 5, b = 6) {
    return a + b;
}

console.log(add()); // 11
console.log(add(1, 2)); // 3
```
ç¬¬äºŒä¸ªå‚æ•°ä½¿ç”¨é»˜è®¤å€¼ï¼š
```js
function add(a = 5, b = 6) {
    return a + b;
}

console.log(add(1)); // 7
```
ç¬¬ä¸€ä¸ªå‚æ•°ä½¿ç”¨é»˜è®¤å€¼ï¼š
```js
function add(a = 5, b = 6) {
    return a + b;
}

console.log(add(undefined, 3)); // 8
```
è¿™é‡Œéœ€è¦æ˜¾ç¤ºæŒ‡å®šç¬¬ä¸€ä¸ªå®å‚ä¸º`undefined`ï¼Œæ‰èƒ½ä½¿ç¬¬ä¸€ä¸ªå‚æ•°é»˜è®¤å€¼ç”Ÿæ•ˆã€‚å› æ­¤ï¼Œå¯ä»¥å¾—å‡ºES6ä¸­é»˜è®¤å‚æ•°çš„å®ç°åŸç†ä¹Ÿæ˜¯è¿ç”¨äº†`typeof a === undefined`æ¥åˆ¤æ–­æ˜¯å¦é‡‡ç”¨é»˜è®¤å‚æ•°çš„ã€‚
## ç®­å¤´å‡½æ•°ä¸é€‚ç”¨åœºæ™¯
1. ä½œä¸ºæ„é€ å‡½æ•°æˆ–è€…ä¸€ä¸ªæ–¹æ³•éœ€è¦ç»‘å®šåˆ°å¯¹è±¡ã€‚
```js
const Person = (name, age) => {
    this.name = name;
    this.age = age;
}

const person = new Person('lisi', 12); // Uncaught TypeError: Person is not a constructor
```
```js
const Person = function(name, age) {
    this.name = name;
    this.age = age;
}

const person = new Person('lisi', 12);
// console.log(person); // Person { name: 'lisi', age: 12 }
Person.prototype.sayName = () => {
    // è¿™é‡Œä¹‹æ‰€ä»¥æ˜¯undefinedçš„åŸå› ï¼šç®­å¤´å‡½æ•°çš„thisæŒ‡å‘æ˜¯å…¶çˆ¶ä½œç”¨åŸŸçš„thisï¼Œåœ¨è¿™é‡Œæ˜¯windowã€‚
    console.log(this.name); // undefined
};

person.sayName();
```
```js
const Person = function(name, age) {
    this.name = name;
    this.age = age;
}

const person = new Person('lisi', 12);
Person.prototype.sayName = function() {
    console.log(this.name); // lisi
};

person.sayName();
```
2. éœ€è¦ä½¿ç”¨thisçš„æ—¶å€™
```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        .box {
            width: 100px;
            height: 100px;
            background-color: aquamarine;
        }
        .in {
            transform: scale(2);
        }
    </style>
</head>
<body>
    <div class="box"></div>
    <script>
        const box = document.querySelector('.box');
        box.addEventListener('click', function() { // è¿™é‡Œä¸èƒ½ä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Œä¼šå¯¼è‡´thisæŒ‡å‘windowè€Œä¸æ˜¯å½“å‰ç‚¹å‡»çš„box
            this.classList.add('in');
            setTimeout(() => { // è¿™é‡Œéœ€è¦ä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Œä½¿å¾—thisæŒ‡å‘å…¶çˆ¶ä½œç”¨åŸŸçš„thisæŒ‡å‘å³boxã€‚ä¸ä½¿ç”¨ç®­å¤´å‡½æ•°åˆ™æŒ‡å‘windowã€‚
                this.classList.remove('in');
            }, 2000);
        });
    </script>
</body>
</html>
```
3. éœ€è¦ä½¿ç”¨argumentså¯¹è±¡
```js
const sum = () => {
    // ç®­å¤´å‡½æ•°ä¸­æ²¡æœ‰argumentså¯¹è±¡
    return [...arguments].reduce((pre, cur) => {
        return pre + cur;
    }, 0);
}

const res = sum(1, 2, 3); // Uncaught ReferenceError: arguments is not defined
console.log(res);
```
```js
const sum = function() { // æ”¹æˆæ™®é€šå‡½æ•°
    return [...arguments].reduce((pre, cur) => {
        return pre + cur;
    }, 0);
}

const res = sum(1, 2, 3); // Uncaught ReferenceError: arguments is not defined
console.log(res); // 6
```
å¦‚æœä½ å°±æ˜¯æƒ³ä½¿ç”¨ç®­å¤´å‡½æ•°çš„è¯ï¼Œå¯ä»¥é‡‡ç”¨rest(...)æ¥æ¥æ”¶å‚æ•°ï¼š
```js
const sum = (...args) => {
    // console.log(args); // [1, 2, 3]
    return args.reduce((pre, cur) => {
        return pre + cur;
    }, 0);
}

const res = sum(1, 2, 3);
console.log(res);
```
## å‰©ä½™å‚æ•°
åº”ç”¨åœºæ™¯ï¼š
* å‡½æ•°å‚æ•°çš„æ¥æ”¶
* è§£æ„èµ‹å€¼
```js
const converCurrency = (rate, ...amounts) => {
    return amounts.map(item => item * rate);
}

const res = converCurrency(1.2, 100, 200, 300);
console.log(res); // [ 120, 240, 360 ]
```
```js
const person = ['lisi', 23, 'ğŸ€', 'âš½ï¸'];
const [name, age, ...hobbies] = person;
console.log(name, age, hobbies); // lisi 23 [ 'ğŸ€', 'âš½ï¸' ]
```